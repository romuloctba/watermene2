(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const C=88,k=document.querySelector("#transparency"),N=document.querySelector("#width"),_=document.querySelector("#currentSize"),L=document.querySelector("#position-x"),w=document.querySelector("#position-y"),$=document.getElementById("resetButton"),W=document.getElementById("closeMain"),G=document.getElementById("how"),f=document.getElementById("how-form"),M=document.querySelector("#imageInput"),T=document.getElementById("backgroundInput"),r=document.querySelector("#menearea"),h=document.getElementById("the-form"),F=document.getElementById("upload-mene"),H=document.getElementById("reset-container"),K=document.getElementById("download"),V=document.getElementById("installButton"),I=document.getElementById("installButtonContainer"),j=document.getElementById("backToSealsButton"),q=document.getElementById("loadingMessage"),m=document.getElementById("instructions-container");function x(){const e=`
    <div class="wordart superhero">
        <div class="logo-ball"></div>
        <h1 class="text">WaterMene</h1>
    </div>
    
    <ol>
        <li>Envie o seu Mene</li>
        <li>Escolha um selo, ou envie</li>
        <li>Posicione</li>
        <li>Faça download!<span class="news-badge">**</span></li>

        <li class="warning">
        **Atenção: Nem todos os watermenes são compliance com a regras do grupo. Contacte o SAC/Moderação em caso de dúvida.
        </li>
    </ol>
    
    `;m.innerHTML=e,l(m)}function J(){i(m),m.innerHTML=""}x();const p=document.getElementById("main"),b=document.getElementById("closeMain");function Q(){if(!p.classList.contains("closed")){p.classList.add("closed"),b.classList.add("closed");return}b.classList.remove("closed"),p.classList.remove("closed")}function X(e){const t=document.querySelector("#how-form .visible");t==null||t.classList.remove("visible"),t==null||t.classList.add("hidden"),console.log("removed"),document.getElementById(e).classList.add("visible"),document.getElementById(e).classList.remove("hidden")}function Y(e){const t=e.target;X(t.value)}function Z(){h.reset(),T.value="",M.value=""}function ee(){Z(),x(),l(F),i(f),i(h),i(H)}function v(e){if(!e.classList.contains("hidden")){i(e);return}l(e)}function l(e){e.classList.remove("hidden")}function i(e){e.classList.add("hidden")}function te(){ee(),le(),R(),O(0,0)}function ne(e){q.innerHTML=`<div class="loadingHeart"><div class="lds-heart"><div></div></div></div> Carregando Selos, aguarde... (#${e}) `}function oe(){i(q)}let B=null,g=C;function D(e){B=e}function se(){return B}function ae(e){const t=se();if(t){const a=parseInt(L.value,10),s=parseInt(w.value,10),o=g,n=g/t.width*t.height,c=parseFloat(k.value||"0.5");e.globalAlpha=c,e.drawImage(t,a,s,o,n),e.globalAlpha=1}}function P(){i(f),l(h)}function ce(e){e.preventDefault(),l(f),i(h)}function ie(e){const a=e.target.files[0],s=new FileReader;s.onload=function(o){const n=new Image;n.onload=function(){D(n),d()},n.src=o.target.result},s.readAsDataURL(a),P()}function re(e){D(e),d(),P()}function de(e){const t=e.target;g=parseInt(t.value,10),_.innerHTML=`${g}px;`,d()}function le(){B=null,g=C}let y=null;function R(e){(e||r.getContext("2d")).clearRect(0,0,r.width,r.height)}function O(e,t){r.width=e,r.height=t}function d(){y!==null&&cancelAnimationFrame(y),y=requestAnimationFrame(()=>{const e=r.getContext("2d");e&&(R(e),fe(e),ae(e))})}function ue(){const e=r.toDataURL("image/png"),t=document.createElement("a");t.href=e,t.download="watermene.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}let U=null;function ge(e){U=e}function me(){return U}function fe(e){const t=me();t&&e.drawImage(t,0,0)}function he(){J(),v(F),v(H),v(f)}function pe(e){const a=e.target.files[0],s=new FileReader;s.onload=o=>{const n=new Image;n.onload=()=>{ge(n),L.setAttribute("max",""+n.width),w.setAttribute("max",""+n.height),O(n.width,n.height),d()},n.src=o.target.result},s.readAsDataURL(a),he()}T.addEventListener("change",pe);W.addEventListener("click",Q);K.addEventListener("click",ue,!1);G.addEventListener("change",Y);M.addEventListener("change",ie);$.addEventListener("click",te);N.addEventListener("change",de);k.addEventListener("input",d);L.addEventListener("input",d);w.addEventListener("input",d);j.addEventListener("click",ce);let u;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),u=e,l(I)});V.addEventListener("click",()=>{u&&(u.prompt(),u.userChoice.then(e=>{e.outcome==="accepted"?console.log("App installed successfully!"):console.log("App installation canceled."),u=void 0,i(I)})),i(I)});const A="data-counter",ve=document.getElementById("slider"),E=[];async function ye(){let e=0,t=!1;for(;!t;)ne(e),await fetch(`seals/seal_${e}.png`,{method:"HEAD"}).then(a=>{if(a.status===404){t=!0,oe();return}E.push(`${e}`),e++});return Promise.resolve()}ye().then(()=>{for(let e=0;e<E.length;e++){console.log("creating el ",e);const t=document.createElement("button");t.setAttribute(A,E[e]),t.classList.add("slide"),t.addEventListener("click",function(){const n=this.getElementsByTagName("img")[0];re(n)});const a=n=>{console.log("intercepted"),setTimeout(()=>{n.forEach(c=>{if(c.isIntersecting){const z=c.target.getAttribute(A),S=document.createElement("img");S.setAttribute("src","seals/seal_"+z+".png"),c.target.appendChild(S),s.unobserve(c.target)}})},750)},s=new IntersectionObserver(a),o=t;s.observe(o),ve.appendChild(t)}});
