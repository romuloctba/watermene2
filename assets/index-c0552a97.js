(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}})();const S=88,b=document.querySelector("#transparency"),v=document.querySelector("#position-x"),I=document.querySelector("#position-y"),P=document.getElementById("resetButton"),R=document.getElementById("sizeSelect"),z=document.getElementById("closeMain"),D=document.getElementById("how"),w=document.getElementById("how-form"),A=document.querySelector("#imageInput"),C=document.getElementById("backgroundInput"),i=document.querySelector("#menearea"),E=document.getElementById("the-form"),k=document.getElementById("upload-mene"),F=document.getElementById("reset-container"),O=document.getElementById("download"),U=document.getElementById("installButton"),y=document.getElementById("installButtonContainer"),m=document.getElementById("instructions-container");function M(){const e=`
    <div class="wordart superhero">
        <div class="logo-ball"></div>
        <h1 class="text">WaterMene</h1>
    </div>
    
    <ol>
        <li>Envie o Mene para adicionar o selo.</li>
        <li>Escolha entre os selos disponíveis<span class="news-badge">*</span> ou envie o seu próprio selo.</li>
        <li>Posicione, escolha o tamanho, e altere a transparência.</li>
        <li>Faça download do seu Mene finalizado<span class="news-badge">**</span></li>
        <li class="warning">
            *Em breve
        </li>
        <li class="warning">
        **Atenção: Nem todos os watermenes são compliance com a regras do grupo. Contacte o SAC/Moderação em caso de dúvida.
        </li>
    </ol>
    
    `;m.innerHTML=e,u(m)}function N(){a(m),m.innerHTML=""}M();const f=document.getElementById("main"),B=document.getElementById("closeMain");function T(){if(!f.classList.contains("closed")){f.classList.add("closed"),B.classList.add("closed");return}B.classList.remove("closed"),f.classList.remove("closed")}function W(e){const t=document.querySelector("#how-form .visible");t==null||t.classList.remove("visible"),t==null||t.classList.add("hidden"),console.log("removed"),document.getElementById(e).classList.add("visible"),document.getElementById(e).classList.remove("hidden")}function _(e){const t=e.target;W(t.value)}function G(){E.reset(),C.value="",A.value=""}function K(){G(),M(),u(k),a(w),a(E),a(F)}function p(e){if(!e.classList.contains("hidden")){a(e);return}u(e)}function u(e){e.classList.remove("hidden")}function a(e){e.classList.add("hidden")}function V(){K(),Z(),x(),q(0,0)}let L=null,g=S;function $(e){L=e}function j(){return L}function J(e){const t=j();if(t){const c=parseInt(v.value,10),s=parseInt(I.value,10),o=g,n=g/t.width*t.height,d=parseFloat(b.value||"0.5");e.globalAlpha=d,e.drawImage(t,c,s,o,n),e.globalAlpha=1}}function Q(){a(w),u(E)}function X(e){const c=e.target.files[0],s=new FileReader;s.onload=function(o){const n=new Image;n.onload=function(){$(n),r()},n.src=o.target.result},s.readAsDataURL(c),Q()}function Y(e){const t=e.target;g=parseInt(t.value,10),r()}function Z(){L=null,g=S}let h=null;function x(e){(e||i.getContext("2d")).clearRect(0,0,i.width,i.height)}function q(e,t){i.width=e,i.height=t}function r(){h!==null&&cancelAnimationFrame(h),h=requestAnimationFrame(()=>{const e=i.getContext("2d");e&&(x(e),oe(e),J(e))})}function ee(){const e=i.toDataURL("image/png"),t=document.createElement("a");t.href=e,t.download="watermene.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}let H=null;function te(e){H=e}function ne(){return H}function oe(e){const t=ne();t&&e.drawImage(t,0,0)}function se(){N(),p(k),p(F),p(w)}function ae(e){const c=e.target.files[0],s=new FileReader;s.onload=o=>{const n=new Image;n.onload=()=>{te(n),v.setAttribute("max",""+n.width),I.setAttribute("max",""+n.height),q(n.width,n.height),r()},n.src=o.target.result},s.readAsDataURL(c),se()}C.addEventListener("change",ae);z.addEventListener("click",T);O.addEventListener("click",ee,!1);D.addEventListener("change",_);A.addEventListener("change",X);P.addEventListener("click",V);R.addEventListener("change",Y);b.addEventListener("input",r);v.addEventListener("input",r);I.addEventListener("input",r);let l;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),l=e,u(y)});U.addEventListener("click",()=>{l&&(l.prompt(),l.userChoice.then(e=>{e.outcome==="accepted"?console.log("App installed successfully!"):console.log("App installation canceled."),l=void 0,a(y)})),a(y)});
