(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const k=171,M=document.querySelector("#transparency"),V=document.querySelector("#width"),j=document.querySelector("#currentSize"),L=document.querySelector("#position-x"),B=document.querySelector("#position-y"),N=document.getElementById("resetButton"),_=document.getElementById("closeMain"),G=document.getElementById("how"),f=document.getElementById("how-form"),x=document.querySelector("#imageInput"),F=document.getElementById("backgroundInput"),c=document.querySelector("#menearea"),p=document.getElementById("the-form"),D=document.getElementById("upload-mene"),H=document.getElementById("reset-container"),K=document.getElementById("download"),Y=document.getElementById("share"),J=document.getElementById("installButton"),E=document.getElementById("installButtonContainer"),Q=document.getElementById("backToSealsButton"),T=document.getElementById("loadingMessage"),h=document.getElementById("instructions-container");function q(){const e=`
    <div class="wordart superhero">
        <div class="logo-ball"></div>
        <h1 class="text">WaterMene</h1>
    </div>
    
    <ol>
        <li>Envie o seu Mene</li>
        <li>Escolha um selo, ou envie sua marca d'água</li>
        <li>Posicione e ajuste</li>
        <li>Compartilhe no Grupo (ou baixe)</span></li>

        <li class="text">
            As imagens serão ajustadas para um máximo de 960px de largura.
        </li>
        <li class="text">
            <h3> Avisos </h3>
            1. Suas imagens <strong>não são</strong> salvas pelos nossos servidores, somente pela rede social que você compartilhar (se compartilhar). <br />
            <br /><br />
            2. Atenção: Nem todos os watermenes são compliance com as regras do grupo. <br />Contacte o SAC/Moderação em caso de dúvida.
            <br /><br />
            3. Este é um projeto de código aberto, sem garantias.
        </li>
        <li class="text">
            <h3>Ver Código Fonte</h3>
            <a href="https://github.com/romuloctba/watermene2" target="blank">
                <img src="https://camo.githubusercontent.com/1204ee3ae24cd3d431669311f6d03d67ed69da03b2439f22ad4b6247021036d3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f77617465726d656e652d76322d677265656e" alt="WaterMene V2" />
            </a>
        </li>
    </ol>

<!--    <div>
      <button id="settingsIcon">
          <span>
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
              Configurar
          </span>
      </button>
    </div>
    -->
    `;h.innerHTML=e,d(h)}function X(){i(h),h.innerHTML=""}q();const v=document.getElementById("main"),C=document.getElementById("closeMain");function Z(){if(!v.classList.contains("closed")){v.classList.add("closed"),C.classList.add("closed");return}C.classList.remove("closed"),v.classList.remove("closed")}function ee(e){const t=document.querySelector("#how-form .visible");t==null||t.classList.remove("visible"),t==null||t.classList.add("hidden"),console.log("removed"),document.getElementById(e).classList.add("visible"),document.getElementById(e).classList.remove("hidden")}function te(e){const t=e.target;ee(t.value)}function ne(){p.reset(),F.value="",x.value=""}function oe(){ne(),q(),d(D),i(f),i(p),i(H)}function w(e){if(!e.classList.contains("hidden")){i(e);return}d(e)}function d(e){e.classList.remove("hidden")}function i(e){e.classList.add("hidden")}function ae(){oe(),me(),P(),W(0,0)}function se(e){T.innerHTML=`<div class="loadingHeart"><div class="lds-heart"><div></div></div></div> Carregando Selos, aguarde... (#${e}) `}function re(){i(T)}let S=null,g=k;function $(e){S=e}function ie(){return S}function ce(e){const t=ie();if(t){const s=parseInt(L.value,10),a=parseInt(B.value,10),o=g,n=g/t.width*t.height,r=parseFloat(M.value||"0.5");e.globalAlpha=r,e.drawImage(t,s,a,o,n),e.globalAlpha=1}}function R(){i(f),d(p)}function le(e){e.preventDefault(),d(f),i(p)}function de(e){const s=e.target.files[0],a=new FileReader;a.onload=function(o){const n=new Image;n.onload=function(){$(n),l()},n.src=o.target.result},a.readAsDataURL(s),R()}function ue(e){$(e),l(),R()}function ge(e){const t=e.target;g=parseInt(t.value,10),j.innerHTML=`${g}px;`,l()}function me(){S=null,g=k}let y=null;function P(e){(e||c.getContext("2d")).clearRect(0,0,c.width,c.height)}function W(e,t){c.width=e,c.height=t}function l(){y!==null&&cancelAnimationFrame(y),y=requestAnimationFrame(()=>{const e=c.getContext("2d");e&&(P(e),ve(e),ce(e))})}function z(){const e=new Date,t=String(e.getDate()).padStart(2,"0"),s=e.toLocaleString("default",{month:"long"}),a=String(e.getFullYear()),o=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0");return`mene-${`${t}-${s}-${a}-${o}-${n}`}.png`}function he(){const e=c.toDataURL("image/png"),t=document.createElement("a");t.href=e,t.download=z(),document.body.appendChild(t),t.click(),document.body.removeChild(t)}let O=null;function fe(e){O=e}function pe(){return O}function ve(e){const t=pe();if(t){const{width:s,height:a}=U(t);e.drawImage(t,0,0,s,a)}}function U(e){return e.width<=960?{width:e.width,height:e.height}:{width:960,height:960/(e.width/e.height)}}function we(){X(),w(D),w(H),w(f)}function ye(e){const s=e.target.files[0],a=new FileReader;a.onload=o=>{const n=new Image;n.onload=()=>{fe(n);const{width:r,height:m}=U(n);L.setAttribute("max",""+r),B.setAttribute("max",""+m),W(r,m),l()},n.src=o.target.result},a.readAsDataURL(s),we()}F.addEventListener("change",ye);_.addEventListener("click",Z);K.addEventListener("click",he,!1);G.addEventListener("change",te);x.addEventListener("change",de);N.addEventListener("click",ae);V.addEventListener("change",ge);M.addEventListener("input",l);L.addEventListener("input",l);B.addEventListener("input",l);Q.addEventListener("click",le);let u;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),u=e,d(E)});J.addEventListener("click",()=>{u&&(u.prompt(),u.userChoice.then(e=>{e.outcome==="accepted"?console.log("App installed successfully!"):console.log("App installation canceled."),u=void 0,i(E)})),i(E)});const A="data-counter",Ee=document.getElementById("slider"),I=[];async function Ie(){let e=0,t=!1;for(;!t;)se(e),await fetch(`seals/seal_${e}.png`,{method:"HEAD"}).then(s=>{if(s.status===404){t=!0,re();return}I.push(`${e}`),e++});return Promise.resolve()}Ie().then(()=>{for(let e=0;e<I.length;e++){console.log("creating el ",e);const t=document.createElement("button");t.setAttribute(A,I[e]),t.classList.add("slide"),t.addEventListener("click",function(){const n=this.getElementsByTagName("img")[0];ue(n)});const s=n=>{console.log("intercepted"),setTimeout(()=>{n.forEach(r=>{if(r.isIntersecting){const m=r.target.getAttribute(A),b=document.createElement("img");b.setAttribute("src","seals/seal_"+m+".png"),r.target.appendChild(b),a.unobserve(r.target)}})},750)},a=new IntersectionObserver(s),o=t;a.observe(o),Ee.appendChild(t)}});async function Le(e){if(navigator.canShare(e))try{await navigator.share(e)}catch(t){t.name!=="AbortError"&&console.error(t.name,t.message)}}function Be(){c.toBlob(e=>{if(!e)return;const s={text:"Veja meu Mene",title:"Mene criado com WaterMene V2",files:[new File([e],z(),{type:e.type})]};Le(s).then(a=>{console.log("shared",a)})})}Y.addEventListener("click",Be);
